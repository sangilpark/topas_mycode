#include <fstream>
#include <stdlib.h>
#include <stdio.h>
#include <string>
#include <cstring>
#include <sstream>
#include <iostream>
#include <fstream>
#include <math.h>
#include <vector>
#include <cctype>
#include <dirent.h>
#include <sys/types.h>

using namespace std;

bool implicitEndian;
bool littleEndian = true;

template <class Type>
void GetValue(char * _val, Type & _rval) {
	if(littleEndian){
		_rval = *(Type *)_val;
	}
	else{
		const int SIZE = sizeof(_rval);
		char ctemp;
		for(int i=0; i<SIZE/2; i++){
			ctemp = _val[i];
			_val[i] = _val[SIZE - 1 - i];
			_val[SIZE - 1 - i] = ctemp;
		}
		_rval = *(Type *)_val;
		littleEndian = true;
	}
}

struct RTPstruct {int seq; string snout_t; double snout_p; double iso_x; double iso_y; double iso_z; double angle; float comp_p; float comp_thi;};
RTPstruct* Init;

double image_ori[3], PS[2], thickness, target[3];
short row, column, Z;
int imageZ;
char manu;

void ImportCT(char*);
int ImportRS(char*, char*);
void ImportRT(char*, string);


//void Convalgo(int, int);
int main(int argc, char* argv[]){
	cout<<"making input file for TOPAS"<<endl;
	string srcD, CTD, outD, RTPname, RTSname, Contourname;
	int option;
	int range, mod, reuse, nHistory, RM, FS, SS, SD, nNodes;
	int parallel;
	double Energy;


	string firstS, rangeM, secondS, stopD, beamO, beamE;


	if(argc == 1)
	{
		cout<<"not supported yet"<<'\n';
		return 0;
	}
	else if(argc == 2)
	{
		string dummy;
		ifstream ss;
		ss.open((argv[1]), std::ios::in);
		cout<<"reading parameter file "<<argv[1]<<endl;

			ss >> dummy >> firstS;
			ss >> dummy >> rangeM;
			ss >> dummy >> secondS;
			ss >> dummy >> beamO;
			ss >> dummy >> stopD;
			ss >> dummy >> beamE;
			ss >> dummy >> outD;
			ss >> dummy >> nNodes;
			ss >> dummy >> nHistory;

		ss.close();
		int beamS = 1;
	}
	else
	{
		cout<<"Wrong input parameter."<< '\n';
		return 0;
	}
	
	ofstream calculating;

	//BCM

	int BCM[6144] = {
			218, 218, 218, 218, 218, 218, 218, 218, 218, 218, 218, 218, 218, 218, 218, 218, 218, 217, 217, 216, 216, 214, 213, 212, 211, 208, 207, 205, 204, 201, 200, 199, 197, 196, 196, 196, 197, 199, 200, 202, 205, 207, 210, 212, 216, 218, 221, 224, 227, 229, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 226, 226, 225, 225, 223, 223, 222, 222, 221, 221, 220, 220, 219, 219, 218, 212, 212, 212, 212, 212, 212, 212, 212, 212, 212, 212, 212, 212, 212, 212, 212, 212, 212, 212, 212, 212, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 222, 218, 218, 218, 218, 218, 218, 218, 218, 218, 218, 218, 218, 218, 218, 218, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217, 216, 216, 216, 216, 216, 216, 216, 216, 216, 216, 216, 216, 216, 216,
			255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 245, 245, 245, 245, 245, 245, 245, 245, 245, 245, 245, 245, 245, 245, 245, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 249, 249, 248, 248, 247, 247, 245, 244, 244, 243, 242, 242, 240, 239, 238, 236, 235, 235, 234, 232, 231, 230, 229, 226, 225, 223, 222, 221, 220, 218, 216, 214, 213, 212, 209, 208, 207, 204, 203, 201, 199, 198, 196, 194, 192, 190, 188, 187, 185, 183, 181, 181, 181, 181, 181, 181, 181, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 138, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 116, 116, 116, 116, 116, 116, 116, 116, 116, 116, 116, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90,
			188, 188, 188, 188, 188, 188, 188, 188, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 185, 185, 185, 185, 185, 185, 184, 184, 184, 184, 184, 184, 184, 184, 181, 181, 179, 179, 178, 178, 178, 176, 176, 175, 173, 172, 170, 170, 169, 169, 168, 166, 165, 163, 162, 160, 159, 159, 157, 157, 157, 156, 156, 156, 156, 156, 157, 157, 157, 159, 159, 175, 175, 175, 175, 175, 175, 175, 176, 178, 181, 184, 184, 184, 184, 184, 184, 184, 184, 184, 185, 185, 187, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 188, 200, 200, 200, 200, 200, 200, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 226, 226, 226, 226, 226, 226, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
			132, 132, 132, 132, 132, 132, 132, 132, 131, 131, 131, 131, 131, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 123, 122, 121, 120, 119, 119, 119, 117, 116, 115, 113, 113, 112, 111, 110, 108, 107, 107, 105, 104, 103, 102, 102, 102, 102, 101, 101, 102, 102, 102, 102, 103, 104, 105, 107, 107, 109, 111, 112, 113, 115, 117, 119, 119, 120, 122, 124, 124, 125, 127, 128, 129, 130, 130, 131, 132, 132, 133, 133, 134, 134, 134, 134, 135, 135, 134, 134, 134, 134, 133, 133, 132, 132, 132, 131, 130, 130, 129, 128, 127, 127, 127, 127, 127, 127, 127, 127, 127, 127, 127, 127, 127, 127, 127, 127, 127, 128, 128, 129, 129, 129, 129, 129, 130, 130, 130, 130, 130, 131, 132, 132, 133, 133, 134, 135, 136, 136, 137, 137, 137, 138, 140, 140, 141, 141, 141, 141, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
			209, 209, 208, 208, 208, 208, 208, 208, 208, 208, 208, 208, 207, 207, 207, 207, 206, 206, 206, 205, 205, 205, 204, 204, 203, 203, 202, 202, 202, 201, 201, 200, 200, 199, 199, 198, 197, 196, 196, 195, 194, 193, 191, 190, 190, 189, 188, 186, 185, 184, 183, 183, 182, 181, 180, 180, 180, 179, 179, 178, 178, 177, 177, 177, 177, 177, 177, 177, 177, 178, 178, 178, 179, 180, 180, 180, 181, 182, 183, 183, 184, 184, 185, 186, 187, 187, 188, 188, 189, 189, 190, 190, 190, 190, 190, 190, 191, 191, 191, 191, 192, 192, 192, 191, 191, 191, 191, 190, 190, 190, 190, 190, 189, 189, 189, 189, 188, 188, 188, 188, 188, 189, 189, 189, 189, 190, 190, 190, 190, 190, 190, 190, 190, 190, 189, 188, 187, 186, 185, 185, 185, 184, 184, 184, 183, 183, 183, 183, 182, 182, 181, 180, 179, 178, 177, 176, 175, 175, 174, 174, 174, 175, 175, 176, 177, 178, 179, 180, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
			193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 197, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185, 190, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
			250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 225, 225, 225, 225, 225, 225, 225, 227, 227, 227, 227, 228, 228, 228, 228, 229, 229, 229, 229, 229, 229, 229, 229, 229, 229, 229, 229, 229, 229, 229, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 246, 245, 245, 245, 245, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 245, 245, 245, 245, 246, 246, 247, 247, 249, 249, 250, 250, 251, 251, 252, 252, 254, 254, 255, 255, 255, 255, 255, 255, 255, 254, 254, 254, 254, 254, 254, 252, 252, 252, 252, 252, 251, 251, 251, 251, 250, 250, 249, 249, 247, 247, 246, 246, 246, 245, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 247, 247, 247, 247, 247, 247, 247, 247, 247, 247, 247, 249, 249, 249, 249, 249, 249, 250, 250, 250, 250, 250, 249, 249, 249, 249, 249, 249, 247, 247, 247, 246, 246, 246, 245, 245, 243, 243, 243, 242, 242, 242, 241, 241, 241, 241, 239, 239, 239, 239,
			236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 224, 224, 224, 224, 223, 223, 221, 220, 220, 219, 218, 217, 215, 215, 214, 214, 213, 213, 212, 212, 210, 210, 210, 210, 210, 210, 210, 210, 210, 209, 209, 209, 208, 208, 207, 207, 205, 205, 204, 204, 204, 202, 202, 202, 202, 204, 204, 204, 205, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 226, 226, 226, 228, 228, 228, 228, 229, 230, 230, 231, 233, 234, 235, 236, 237, 239, 239, 239, 239, 239, 239, 239, 237, 237, 237, 237, 237, 237, 237, 237, 237, 237, 237, 237, 237, 237, 239, 239, 239, 240, 240, 240, 241, 241, 242, 242, 244, 244, 245, 245, 246, 246, 247, 249, 249, 249, 250, 250, 250, 250, 250, 249, 249, 249, 247, 247, 247, 249, 249, 250, 250, 251, 252, 252, 255, 252, 252, 252, 251, 251, 250, 249, 249, 247, 246, 245, 244, 242, 241, 240, 239, 237, 235, 234, 233, 231, 230, 229, 228, 226, 225, 224, 223, 220, 219, 218, 217, 214, 213, 210, 209, 207, 205, 204, 202, 201, 201, 201, 201, 201, 201, 202, 202, 204, 204, 204, 204, 204, 204, 204, 202, 202, 202, 202, 202, 202, 202, 202,
			239, 239, 239, 239, 239, 239, 239, 239, 239, 220, 220, 219, 218, 218, 217, 217, 215, 215, 214, 214, 214, 213, 213, 213, 213, 214, 214, 214, 214, 215, 215, 217, 217, 218, 219, 219, 220, 222, 223, 225, 227, 228, 229, 232, 233, 236, 237, 239, 241, 242, 244, 246, 247, 248, 249, 251, 252, 253, 255, 255, 255, 255, 255, 253, 252, 251, 249, 248, 246, 244, 242, 241, 238, 237, 236, 234, 233, 232, 232, 231, 229, 228, 228, 227, 227, 225, 225, 224, 224, 224, 223, 223, 222, 222, 220, 220, 219, 218, 218, 217, 215, 214, 213, 212, 210, 209, 208, 205, 204, 201, 201, 201, 196, 196, 196, 196, 196, 196, 196, 196, 196, 196, 196, 196, 196, 196, 196, 196, 196, 196, 227, 227, 227, 227, 227, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227,
			251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 251, 252, 252, 253, 253, 255, 255, 255, 253, 253, 252, 252, 251, 249, 248, 247, 246, 244, 243, 242, 241, 238, 237, 236, 234, 233, 231, 229, 228, 227, 226, 224, 223, 222, 221, 219, 218, 217, 216, 213, 212, 211, 209, 207, 206, 203, 202, 199, 198, 195, 194, 193, 190, 189, 187, 185, 184, 183, 180, 179, 178, 175, 174, 172, 169, 167, 164, 162, 159, 157, 154, 153, 150, 148, 146, 144, 143, 140, 139, 157, 157, 157, 157, 157, 157, 157, 157, 157, 157, 157, 157, 157, 157, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 75, 213, 213, 213, 213, 213, 213, 213, 213, 213, 213, 213, 213, 213, 213, 213, 213, 213, 213, 213, 213, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
			199, 199, 199, 199, 199, 199, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 164, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 184, 214, 214, 214, 204, 204, 204, 204, 204, 204, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
			129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 128, 128, 128, 128, 126, 126, 126, 125, 125, 124, 124, 124, 124, 124, 124, 122, 122, 122, 122, 121, 121, 121, 120, 120, 119, 118, 118, 118, 117, 116, 116, 116, 115, 113, 113, 112, 111, 110, 110, 110, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 109, 110, 110, 110, 111, 112, 113, 113, 115, 116, 116, 117, 117, 118, 118, 119, 120, 121, 121, 122, 122, 124, 124, 125, 126, 128, 129, 129, 129, 130, 130, 132, 132, 132, 132, 132, 132, 130, 130, 129, 129, 129, 126, 125, 124, 124, 122, 121, 121, 119, 119, 118, 118, 118, 118, 118, 118, 118, 118, 118, 119, 120, 121, 122, 124, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 151, 151, 151, 151, 151, 151, 151, 151, 151, 151, 151, 151, 151, 238, 238, 238, 238, 238, 238, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
			238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 237, 237, 237, 237, 237, 237, 237, 237, 237, 237, 237, 237, 237, 237, 237, 238, 238, 238, 239, 239, 240, 240, 242, 242, 243, 243, 244, 244, 244, 246, 246, 246, 246, 244, 244, 243, 243, 242, 240, 239, 239, 238, 238, 238, 238, 238, 239, 239, 239, 239, 239, 239, 239, 238, 238, 237, 237, 235, 235, 235, 237, 237, 237, 238, 238, 239, 239, 240, 242, 242, 243, 244, 244, 246, 246, 247, 246, 246, 246, 246, 244, 244, 244, 243, 244, 244, 244, 244, 244, 244, 244, 244, 244, 244, 244, 244, 243, 243, 243, 243, 242, 242, 240, 240, 239, 238, 238, 237, 237, 237, 237, 235, 235, 235, 235, 235, 235, 234, 234, 234, 233, 233, 233, 233, 233, 233, 233, 233, 234, 234, 235, 235, 235, 237, 237, 238, 238, 239, 239, 239, 238, 238, 238, 237, 235, 234, 233, 233, 231, 230, 230, 229, 229, 227, 227, 226, 226, 225, 225, 223, 223, 223, 223, 223, 225, 226, 226, 227, 229, 230, 231, 233, 234, 235, 237, 238, 239, 240, 242, 243, 244, 246, 247, 248, 250, 251, 252, 252, 254, 254, 254, 255, 255, 255, 254, 254, 254, 254, 252, 252, 252, 252, 252, 252, 252, 252, 252, 251, 251, 251, 251, 250, 250, 248, 248, 247, 247, 246, 246, 246, 246, 244, 244,
			240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 241, 241, 241, 241, 241, 241, 241, 241, 241, 241, 242, 242, 242, 242, 242, 242, 242, 242, 242, 242, 242, 242, 243, 243, 243, 243, 243, 243, 243, 242, 242, 242, 242, 242, 242, 242, 241, 241, 241, 240, 240, 240, 240, 239, 239, 239, 239, 240, 240, 240, 240, 241, 241, 241, 242, 242, 243, 243, 244, 244, 244, 245, 247, 247, 248, 249, 250, 250, 251, 252, 252, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 254, 254, 254, 254, 254, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 254, 254, 254, 253, 253, 252, 252, 251, 250, 250, 249, 248, 248, 247, 245, 244, 243, 242, 241, 240, 238, 237, 236, 235, 233, 232, 232, 231, 230, 230, 228, 228, 228, 228, 228, 228, 230, 230, 230, 230, 230, 230, 230, 230, 230, 230, 230, 231, 232, 232, 233, 234, 234, 235, 235, 235, 235, 235, 235, 235, 235, 236, 236, 236, 236, 236, 236, 236, 235, 234, 233, 232, 231, 230, 228, 227, 226, 225, 224, 223, 222, 221, 219, 217, 216, 214, 211, 210, 208, 207, 206, 205, 204, 204, 203, 202, 202, 202, 202, 203, 203, 204, 205, 206, 207, 207, 208, 209, 209, 210, 211, 213, 214, 215, 217, 218, 219, 221, 222, 223, 224, 224, 225, 225, 226, 226, 226, 225, 225, 225, 225, 225, 225, 225, 225, 225, 225, 226, 226, 226, 227, 227, 227, 227, 228, 228, 228, 228, 228, 228,
			246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 248, 248, 248, 248, 248, 249, 249, 249, 250, 250, 252, 252, 252, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 252, 252, 250, 250, 249, 249, 248, 248, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 248, 248, 249, 250, 250, 252, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 255, 255, 255, 255, 255, 255, 255, 255, 255, 253, 253, 253, 252, 252, 252, 250, 250, 252, 252, 252, 253, 253, 253, 253, 253, 253, 253, 252, 252, 252, 250, 250, 249, 249, 248, 246, 245, 242, 241, 239, 238, 238, 237, 235, 235, 235, 235, 235, 235, 237, 237, 237, 238, 238, 238, 238, 238, 238, 238, 238, 237, 237, 237, 237, 237, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 234, 234, 234, 234, 234, 233, 233, 233, 233, 234, 234, 234, 234, 235, 235, 237, 237, 237, 238, 238, 238, 239, 239, 239, 241, 241, 242, 242, 242, 242, 244, 244, 244, 244, 244, 245, 245, 245, 245, 246, 246, 246,
			235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 235, 223, 223, 223, 224, 224, 224, 223, 223, 223, 223, 221, 221, 221, 221, 221, 220, 220, 220, 220, 220, 220, 221, 221, 221, 221, 223, 223, 223, 223, 223, 223, 223, 223, 221, 220, 219, 219, 218, 218, 230, 230, 230, 230, 230, 230, 230, 230, 230, 230, 230, 230, 230, 230, 230, 230, 230, 230, 230, 230, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 228, 228, 228, 228, 229, 229, 230, 230, 231, 231, 232, 234, 235, 236, 237, 239, 241, 242, 245, 246, 247, 250, 251, 252, 252, 252, 252, 251, 251, 250, 250, 249, 249, 249, 249, 249, 249, 250, 250, 250, 251, 251, 252, 252, 255, 255, 255, 255, 255, 255, 255, 255, 255, 252, 252, 251, 250, 249, 247, 245, 244, 241, 239, 236, 234, 231, 229, 226, 224, 220, 218, 215, 211, 209, 205, 202, 199, 197, 194, 192, 191, 189, 188, 188, 187, 188, 188, 189, 191, 192, 194, 196, 198, 199, 202, 204, 206, 209, 211, 214, 215, 218, 220, 221, 224, 225, 226, 226, 228, 228, 229, 229, 229, 229, 229,
			255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 208, 208, 208, 208, 207, 207, 207, 207, 206, 206, 206, 205, 205, 204, 204, 204, 202, 202, 201, 201, 200, 200, 199, 199, 198, 198, 198, 197, 197, 197, 197, 195, 195, 195, 195, 197, 197, 197, 198, 199, 200, 201, 202, 204, 206, 207, 208, 209, 210, 212, 213, 213, 213, 214, 214, 214, 213, 213, 213, 212, 210, 210, 209, 208, 208, 207, 206, 206, 205, 204, 202, 202, 201, 200, 199, 199, 198, 197, 195, 194, 194, 193, 193, 192, 192, 191, 191, 191, 190, 188, 188, 186, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 168, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98,
			255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 252, 252, 252, 251, 251, 251, 250, 250, 250, 249, 249, 248, 248, 247, 247, 246, 245, 245, 244, 243, 243, 242, 241, 240, 239, 238, 238, 237, 236, 235, 234, 232, 231, 230, 229, 228, 226, 225, 224, 222, 221, 220, 218, 217, 215, 214, 212, 210, 209, 207, 205, 204, 202, 200, 198, 196, 194, 192, 190, 188, 186, 184, 182, 180, 178, 176, 174, 172, 169, 167, 165, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 163, 145, 145, 145, 145, 145, 145, 145, 145, 145, 145, 145, 145, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 100, 100, 115, 115, 115, 115, 115, 115, 115, 115, 115, 115, 115, 115, 120, 120, 120, 120, 120, 120, 120, 120, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 125,
			246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 244, 244, 244, 244, 242, 242, 242, 242, 238, 238, 238, 237, 237, 237, 237, 237, 237, 237, 237, 237, 235, 235, 233, 233, 233, 233, 231, 231, 231, 231, 231, 231, 231, 231, 231, 231, 231, 231, 231, 231, 231, 231, 231, 233, 233, 233, 233, 235, 237, 237, 237, 237, 237, 237, 237, 237, 237, 237, 237, 238, 238, 238, 242, 244, 244, 246, 246, 246, 246, 246, 248, 248, 249, 251, 251, 251, 251, 251, 251, 251, 251, 253, 253, 251, 251, 251, 251, 251, 251, 249, 249, 249, 248, 248, 248, 248, 248, 248, 248, 248, 248, 248, 248, 248, 249, 249, 249, 249, 251, 251, 251, 251, 251, 233, 235, 237, 237, 237, 238, 242, 242, 246, 246, 248, 249, 251, 253, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
			128, 128, 128, 128, 128, 127, 127, 127, 127, 127, 127, 127, 127, 126, 126, 126, 126, 126, 126, 126, 126, 124, 124, 124, 124, 124, 124, 124, 124, 123, 123, 122, 122, 121, 120, 120, 120, 120, 119, 119, 118, 117, 117, 116, 116, 114, 114, 113, 113, 112, 111, 110, 110, 110, 109, 109, 109, 108, 108, 108, 108, 108, 108, 109, 109, 109, 110, 110, 110, 111, 112, 113, 114, 114, 116, 117, 118, 119, 119, 120, 120, 121, 122, 123, 123, 124, 124, 124, 124, 124, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 124, 124, 124, 124, 124, 123, 122, 121, 121, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 121, 121, 121, 122, 122, 123, 123, 124, 124, 124, 124, 124, 124, 124, 124, 124, 124, 124, 124, 124, 126, 126, 126, 127, 127, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 130, 130, 130, 130, 130, 130, 130, 130, 130, 130, 130, 130, 130, 130, 130, 131, 132, 133, 134, 134, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 175, 175, 175, 175, 180, 180, 180, 180, 180, 180, 210, 210, 210, 210, 230, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
			198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 198, 195, 194, 193, 192, 191, 191, 190, 189, 189, 187, 187, 186, 186, 186, 184, 184, 184, 184, 184, 184, 184, 184, 186, 186, 186, 186, 186, 187, 187, 187, 189, 189, 190, 190, 191, 191, 191, 191, 192, 192, 193, 193, 193, 194, 194, 194, 195, 195, 194, 194, 194, 193, 192, 192, 191, 190, 189, 189, 187, 186, 186, 186, 186, 186, 186, 186, 184, 184, 184, 184, 184, 183, 183, 182, 182, 181, 180, 178, 178, 178, 177, 177, 175, 175, 175, 175, 175, 174, 174, 172, 171, 170, 169, 168, 166, 165, 165, 163, 163, 162, 162, 162, 162, 162, 162, 162, 162, 163, 163, 163, 165, 165, 165, 166, 166, 166, 166, 166, 168, 168, 168, 168, 168, 168, 168, 166, 166, 166, 166, 166, 166, 166, 166, 165, 165, 163, 163, 163, 162, 162, 162, 162, 162, 162, 162, 162, 162, 162, 162, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 162, 162, 165, 166, 168, 170, 172, 174, 175, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
			233, 233, 233, 233, 233, 233, 233, 233, 234, 234, 234, 234, 234, 235, 235, 235, 236, 236, 236, 237, 237, 238, 238, 239, 239, 241, 241, 242, 242, 243, 243, 244, 245, 245, 246, 246, 247, 248, 248, 249, 249, 251, 251, 252, 252, 252, 253, 253, 253, 253, 253, 254, 254, 254, 254, 254, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 254, 254, 254, 254, 254, 253, 253, 253, 253, 252, 252, 252, 252, 252, 251, 251, 251, 251, 249, 249, 248, 248, 248, 247, 247, 247, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 245, 245, 245, 245, 245, 245, 245, 244, 244, 244, 243, 242, 242, 241, 239, 238, 237, 235, 235, 234, 233, 232, 232, 232, 231, 231, 231, 231, 231, 231, 232, 232, 232, 232, 232, 233, 234, 234, 235, 235, 236, 236, 236, 236, 235, 234, 234, 233, 232, 231, 229, 228, 227, 226, 226, 225, 224, 223, 222, 220, 219, 218, 216, 216, 215, 214, 214, 213, 213, 212, 212, 210, 209, 208, 207, 206, 205, 204, 203, 202, 200, 199, 198, 197, 196, 195, 194, 193, 193, 193, 192, 192, 192, 190, 190, 189, 189, 188, 188, 187, 187, 187, 187, 187, 187, 187, 188, 188, 189, 190, 192, 192, 193, 194, 195, 195, 195, 196, 196, 196, 196, 196, 195, 194, 194, 193, 193, 192, 192, 190, 190, 189, 189, 189, 189, 188, 188, 188, 188,
			240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 240, 241, 241, 241, 241, 241, 241, 241, 241, 241, 241, 240, 240, 240, 240, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 238, 240, 240, 240, 240, 241, 241, 242, 242, 244, 244, 245, 245, 246, 246, 246, 248, 248, 248, 248, 248, 248, 248, 248, 248, 248, 248, 248, 249, 249, 249, 250, 250, 252, 252, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 252, 252, 252, 252, 250, 250, 250, 250, 250, 250, 250, 250, 250, 249, 249, 248, 248, 248, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 246, 248, 248, 248, 248, 248, 248, 248, 246, 246, 245, 244, 244, 242, 242, 242, 242, 241, 241, 242, 242, 242, 241, 241, 241, 240, 240, 238, 237, 236, 234, 233, 232, 230, 230, 229, 229, 228, 228, 228, 229, 229, 230, 232, 232, 233, 234, 236, 236, 236, 236, 236, 236, 236, 234, 234, 233, 232, 230, 230, 229, 229, 228, 228, 226, 225, 225, 224, 224, 222, 222, 221, 221, 221, 221, 220, 220, 220, 221, 221, 221, 222, 222, 224, 225, 226, 228, 229, 230, 232, 234, 237, 238, 241, 244, 245, 248, 249, 250, 252, 253, 255, 255, 255, 255, 255, 255, 255,
			232, 232, 232, 232, 232, 232, 232, 232, 232, 232, 230, 230, 230, 230, 230, 230, 230, 230, 229, 229, 229, 229, 229, 228, 228, 228, 228, 228, 228, 227, 227, 227, 227, 227, 227, 227, 227, 227, 227, 225, 225, 225, 225, 225, 225, 225, 225, 225, 225, 225, 225, 227, 227, 228, 228, 229, 230, 232, 233, 234, 236, 237, 238, 241, 242, 243, 245, 246, 247, 248, 250, 251, 251, 251, 251, 251, 251, 251, 251, 251, 250, 250, 250, 250, 248, 247, 246, 245, 243, 242, 241, 238, 237, 236, 234, 233, 232, 230, 229, 229, 228, 228, 227, 227, 227, 225, 225, 227, 227, 227, 227, 228, 229, 229, 230, 232, 232, 233, 233, 234, 234, 234, 234, 236, 236, 236, 236, 236, 237, 237, 238, 238, 239, 239, 241, 241, 242, 243, 243, 245, 245, 246, 246, 246, 246, 246, 245, 245, 245, 243, 243, 243, 245, 245, 246, 246, 246, 247, 247, 247, 246, 246, 246, 246, 246, 246, 247, 247, 247, 248, 248, 250, 250, 251, 251, 252, 252, 252, 252, 252, 252, 252, 251, 251, 251, 251, 251, 251, 252, 252, 252, 252, 252, 255, 252, 252, 252, 252, 252, 251, 251, 250, 248, 247, 246, 245, 243, 242, 241, 238, 237, 234, 232, 229, 227, 223, 220, 218, 215, 212, 210, 207, 206, 204, 201, 200, 197, 196, 196, 195, 195, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 194, 205
			};


	// Recording input-file

		char a[3];
		string cal = "RecordPhase.txt";

		char *re3 = new char[cal.length()+1];

		strcpy(re3, cal.c_str());
		calculating.open(re3);

		delete re3;

		// DSF
		calculating<<"includeFile = N01_IC1.txt N02_FS.txt N03_RM.txt N05_SS.txt N07_IC2.txt N08_SNT-1.txt ConstantsForNozzles.txt"<<'\n';
		calculating<<"Ge/RMW_"<<(atoi(rangeM.c_str())+2)/3<<"/RotZ = Tf/RMW_Rotation/Value deg"<<'\n';
		calculating<<"Ge/CheckForOverlaps = \"t\""<<'\n';
		calculating<<"dv:Tf/BeamWeight/Times = 256	0	3.921569e-001	7.843137e-001	1.176471e+000	1.568627e+000	1.960784e+000	2.352941e+000	2.745098e+000	3.137255e+000	3.529412e+000	3.921569e+000	4.313725e+000	4.705882e+000	5.098039e+000	5.490196e+000	5.882353e+000	6.274510e+000	6.666667e+000	7.058824e+000	7.450980e+000	7.843137e+000	8.235294e+000	8.627451e+000	9.019608e+000	9.411765e+000	9.803922e+000	1.019608e+001	1.058824e+001	1.098039e+001	1.137255e+001	1.176471e+001	1.215686e+001	1.254902e+001	1.294118e+001	1.333333e+001	1.372549e+001	1.411765e+001	1.450980e+001	1.490196e+001	1.529412e+001	1.568627e+001	1.607843e+001	1.647059e+001	1.686275e+001	1.725490e+001	1.764706e+001	1.803922e+001	1.843137e+001	1.882353e+001	1.921569e+001	1.960784e+001	20	2.039216e+001	2.078431e+001	2.117647e+001	2.156863e+001	2.196078e+001	2.235294e+001	2.274510e+001	2.313725e+001	2.352941e+001	2.392157e+001	2.431373e+001	2.470588e+001	2.509804e+001	2.549020e+001	2.588235e+001	2.627451e+001	2.666667e+001	2.705882e+001	2.745098e+001	2.784314e+001	2.823529e+001	2.862745e+001	2.901961e+001	2.941176e+001	2.980392e+001	3.019608e+001	3.058824e+001	3.098039e+001	3.137255e+001	3.176471e+001	3.215686e+001	3.254902e+001	3.294118e+001	3.333333e+001	3.372549e+001	3.411765e+001	3.450980e+001	3.490196e+001	3.529412e+001	3.568627e+001	3.607843e+001	3.647059e+001	3.686275e+001	3.725490e+001	3.764706e+001	3.803922e+001	3.843137e+001	3.882353e+001	3.921569e+001	3.960784e+001	40	4.039216e+001	4.078431e+001	4.117647e+001	4.156863e+001	4.196078e+001	4.235294e+001	4.274510e+001	4.313725e+001	4.352941e+001	4.392157e+001	4.431373e+001	4.470588e+001	4.509804e+001	4.549020e+001	4.588235e+001	4.627451e+001	4.666667e+001	4.705882e+001	4.745098e+001	4.784314e+001	4.823529e+001	4.862745e+001	4.901961e+001	4.941176e+001	4.980392e+001	5.019608e+001	5.058824e+001	5.098039e+001	5.137255e+001	5.176471e+001	5.215686e+001	5.254902e+001	5.294118e+001	5.333333e+001	5.372549e+001	5.411765e+001	5.450980e+001	5.490196e+001	5.529412e+001	5.568627e+001	5.607843e+001	5.647059e+001	5.686275e+001	5.725490e+001	5.764706e+001	5.803922e+001	5.843137e+001	5.882353e+001	5.921569e+001	5.960784e+001	60	6.039216e+001	6.078431e+001	6.117647e+001	6.156863e+001	6.196078e+001	6.235294e+001	6.274510e+001	6.313725e+001	6.352941e+001	6.392157e+001	6.431373e+001	6.470588e+001	6.509804e+001	6.549020e+001	6.588235e+001	6.627451e+001	6.666667e+001	6.705882e+001	6.745098e+001	6.784314e+001	6.823529e+001	6.862745e+001	6.901961e+001	6.941176e+001	6.980392e+001	7.019608e+001	7.058824e+001	7.098039e+001	7.137255e+001	7.176471e+001	7.215686e+001	7.254902e+001	7.294118e+001	7.333333e+001	7.372549e+001	7.411765e+001	7.450980e+001	7.490196e+001	7.529412e+001	7.568627e+001	7.607843e+001	7.647059e+001	7.686275e+001	7.725490e+001	7.764706e+001	7.803922e+001	7.843137e+001	7.882353e+001	7.921569e+001	7.960784e+001	80	8.039216e+001	8.078431e+001	8.117647e+001	8.156863e+001	8.196078e+001	8.235294e+001	8.274510e+001	8.313725e+001	8.352941e+001	8.392157e+001	8.431373e+001	8.470588e+001	8.509804e+001	8.549020e+001	8.588235e+001	8.627451e+001	8.666667e+001	8.705882e+001	8.745098e+001	8.784314e+001	8.823529e+001	8.862745e+001	8.901961e+001	8.941176e+001	8.980392e+001	9.019608e+001	9.058824e+001	9.098039e+001	9.137255e+001	9.176471e+001	9.215686e+001	9.254902e+001	9.294118e+001	9.333333e+001	9.372549e+001	9.411765e+001	9.450980e+001	9.490196e+001	9.529412e+001	9.568627e+001	9.607843e+001	9.647059e+001	9.686275e+001	9.725490e+001	9.764706e+001	9.803922e+001	9.843137e+001	9.882353e+001	9.921569e+001	9.960784e+001	100	ms"<<'\n';
		
		calculating<<"iv:Tf/BeamWeight/Values = 256 ";
        int BeamOption = (beamO[1] - '0') +(beamO[3] - '0' - 1)*8;
        for(int i=0;i<3;i++)
        {
            calculating<<0<<" ";
        }
        for(int i=(BeamOption-1)*256+3;i<BeamOption*256;i++)
        {
            calculating<<BCM[i]<<" ";
        }
        int accumulate_particle = 0;

        for(int i=(BeamOption-1)*256+3;i<(BeamOption-1)*256+atoi(stopD.c_str())-1;i++){
            accumulate_particle +=BCM[i];
        }

        cout<<"total "<<accumulate_particle<<" particles/nHistory"<<endl;

		calculating<<'\n'<<"s:Tf/BeamCurrent/Function = \"Step\""<<'\n';
		calculating<<"dv:Tf/BeamCurrent/Times = 1 100 ms"<<'\n';
		calculating<<"iv:Tf/BeamCurrent/Values = 1 "<<nHistory<<'\n';
		calculating<<"i:Tf/BCM_1/Value = Tf/BeamCurrent/Value * Tf/BeamWeight/Value"<<'\n';
		calculating<<"So/Demo/NumberOfHistoriesInRun= Tf/BCM_1/Value"<<'\n';

		double stop = atof(stopD.c_str())/256*100;
		calculating<<"d:Tf/TimelineEnd="<<stop<<" ms"<<'\n';
		calculating<<"i:Tf/NumberOfSequentialTimes="<<stopD<<'\n';

		calculating<<"Ge/RMW/Track = -1 * Ge/RMW/Track"<<rangeM<<" deg"<<'\n';

		calculating<<"d:Ge/RMW/Track/zero_angle = Ge/RMW/Track"<<rangeM<<" - Ge/RMW/Small/Track"<<(atoi(rangeM.c_str())+2)%3<<" deg"<<'\n';

		calculating<<"s:Tf/RMW_Rotation/Function = \"Linear deg\""<<'\n';
		calculating<<"d:Tf/RMW_Rotation/Rate = 3.6 deg/ms"<<'\n';
		calculating<<"d:Tf/RMW_Rotation/StartValue = Ge/RMW/Track/zero_angle deg"<<'\n';
		calculating<<"d:Tf/RMW_Rotation/RepetitionInterval = 100. ms"<<'\n';

		calculating<<"Ts/PauseBeforeSequence=\"F\""<<'\n';
		calculating<<"i:Ts/ShowHistoryCountAtInterval = 0"<<'\n';
    
    
        int i=0;
        while(firstS[i]!=0){
            calculating<<"Ge/Scatterer1/Lollipop"<<firstS[i]<<" = Ge/Scatterer1/RotZ_InBeam deg"<<'\n';
            i++;

        }
    
    
		calculating<<"d:Ge/Scatterer2/Holder/RotZ = Ge/Scatterer2/RotZForS"<<secondS<<" deg"<<'\n';


		calculating<<"Ge/Snout/TransZ = "<<-432.5<<" mm"<<'\n';
		calculating<<"Ge/Snout/SNTTypeR1 = Ge/Snout/SNT"<<250<<"R1 mm"<<'\n';
		calculating<<"Ge/Snout/SNTTypeR2 = Ge/Snout/SNT"<<250<<"R2 mm"<<'\n';
	        //calculating<<"Ge/Aperture/InputFile = \"ApertureFileIn"<<a<<".ap\""<<'\n';
		// Beam
		calculating<<"s:So/Demo/Component              = \"BeamPosition\""<<'\n';
		calculating<<"s:So/Demo/BeamPositionCutoffShape= \"Ellipse\""<<'\n';
		calculating<<"d:So/Demo/BeamEnergy             = "<<beamE<<" MeV"<<'\n';
		calculating<<"u:So/Demo/BeamEnergySpread       = "<<
(1.0289-0.0008*((log(atof(beamE.c_str()))-3.432)/0.5636))/atof(beamE.c_str())*100<<'\n';
//1.01/E_data[beamSe]*100<<'\n';
		calculating<<"s:So/Demo/BeamPositionDistribution = \"Gaussian\""<<'\n';
		calculating<<"d:So/Demo/BeamPositionCutoffX = 0.1 cm"<<'\n';
		calculating<<"d:So/Demo/BeamPositionCutoffY = 0.1 cm"<<'\n';
		calculating<<"d:So/Demo/BeamPositionSpreadX = 0.1 cm"<<'\n';
		calculating<<"d:So/Demo/BeamPositionSpreadY = 0.1 cm"<<'\n';
		calculating<<"s:So/Demo/BeamAngularDistribution = \"Gaussian\""<<'\n';
		calculating<<"d:So/Demo/BeamAngularCutoffX     = 0.01 deg"<<'\n';
		calculating<<"d:So/Demo/BeamAngularCutoffY     = 0.01 deg"<<'\n';
		calculating<<"d:So/Demo/BeamAngularSpreadX     = 0.01 deg"<<'\n';
		calculating<<"d:So/Demo/BeamAngularSpreadY     = 0.01 deg"<<'\n';

		// Phase-space
		calculating<<"s:Sc/PhaseSpaceAtVacFilm/Quantity = \"PhaseSpace\""<<'\n';
		calculating<<"b:Sc/PhaseSpaceAtVacFilm/OutputToConsole = \"True\""<<'\n';
		calculating<<"s:Sc/PhaseSpaceAtVacFilm/Surface = \"ZPhaseSpaceVol/ZMinusSurface\""<<'\n';
		calculating<<"s:Sc/PhaseSpaceAtVacFilm/OutputType = \"Binary\""<<'\n';
		calculating<<"b:Sc/PhaseSpaceAtVacFilm/IncludeTOPASTime = \"False\""<<'\n';
		calculating<<"b:Sc/PhaseSpaceAtVacFilm/IncludeTimeOfFlight = \"False\""<<'\n';
		calculating<<"b:Sc/PhaseSpaceAtVacFilm/IncludeRunID   = \"False\""<<'\n';
		calculating<<"b:Sc/PhaseSpaceAtVacFilm/IncludeEventID = \"False\""<<'\n';
		calculating<<"b:Sc/PhaseSpaceAtVacFilm/IncludeTrackID = \"False\""<<'\n';
		calculating<<"b:Sc/PhaseSpaceAtVacFilm/IncludeParentID = \"False\""<<'\n';
		calculating<<"b:Sc/PhaseSpaceAtVacFilm/IncludeVertexInfo = \"True\""<<'\n';
		calculating<<"b:Sc/PhaseSpaceAtVacFilm/IncludeSeed = \"False\""<<'\n';
		calculating<<"sv:Sc/PhaseSpaceAtVacFilm/OnlyIncludeParticlesNamed = 2 \"proton\" \"neutron\""<<'\n';
		calculating<<"s:Sc/PhaseSpaceAtVacFilm/IfOutputFileAlreadyExists = \"Increment\""<<'\n';
		calculating<<"s:Sc/PhaseSpaceAtVacFilm/OutputFile = \""<<outD<<"/Phase"<<a<<"\""<<'\n';
		calculating<<"s:Ge/Aperture/InputFile = \"ApertureFileIn"<<a<<".ap\""<<'\n';
		//calculating<<"Ge/Compensator/InputFile = \"CompensatorFileInRowsDepths"<<a<<".rc\""<<'\n';










		calculating<<"i:Ts/NumberOfThreads = "<<nNodes<<'\n';
		calculating<<"b:Ge/QuitIfOverlapDetected = \"F\""<<'\n';
		calculating<<"i:Ts/MaxInterruptedHistories = 100000000"<<'\n';






		calculating.close();
    


}
